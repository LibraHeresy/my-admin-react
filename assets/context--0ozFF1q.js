import{a as n,y as H,z as ge,e as ee,c as Q,w as ue,R as U,P as Re,G as Ne,x as J,_ as V,Q as pe}from"./index-DvwZ1ndD.js";import{p as Ae,v as Pe}from"./EllipsisOutlined-cGCnUEvk.js";var _e=n.forwardRef(function(t,a){var d=t.prefixCls,c=t.style,l=t.className,N=t.duration,C=N===void 0?4.5:N,A=t.showProgress,b=t.pauseOnHover,P=b===void 0?!0:b,F=t.eventKey,O=t.content,m=t.closable,g=t.closeIcon,w=g===void 0?"x":g,y=t.props,f=t.onClick,j=t.onNoticeClose,I=t.times,E=t.hovering,S=n.useState(!1),x=H(S,2),u=x[0],p=x[1],o=n.useState(0),e=H(o,2),r=e[0],s=e[1],R=n.useState(0),_=H(R,2),k=_[0],q=_[1],v=E||u,L=C>0&&A,T=function(){j(F)},z=function(i){(i.key==="Enter"||i.code==="Enter"||i.keyCode===Pe.ENTER)&&T()};n.useEffect(function(){if(!v&&C>0){var M=Date.now()-k,i=setTimeout(function(){T()},C*1e3-k);return function(){P&&clearTimeout(i),q(Date.now()-M)}}},[C,v,I]),n.useEffect(function(){if(!v&&L&&(P||k===0)){var M=performance.now(),i,h=function ne(){cancelAnimationFrame(i),i=requestAnimationFrame(function(oe){var G=oe+k-M,K=Math.min(G/(C*1e3),1);s(K*100),K<1&&ne()})};return h(),function(){P&&cancelAnimationFrame(i)}}},[C,k,v,L,I]);var X=n.useMemo(function(){return ge(m)==="object"&&m!==null?m:m?{closeIcon:w}:{}},[m,w]),te=Ae(X,!0),$=100-(!r||r<0?0:r>100?100:r),D="".concat(d,"-notice");return n.createElement("div",ee({},y,{ref:a,className:Q(D,l,ue({},"".concat(D,"-closable"),m)),style:c,onMouseEnter:function(i){var h;p(!0),y==null||(h=y.onMouseEnter)===null||h===void 0||h.call(y,i)},onMouseLeave:function(i){var h;p(!1),y==null||(h=y.onMouseLeave)===null||h===void 0||h.call(y,i)},onClick:f}),n.createElement("div",{className:"".concat(D,"-content")},O),m&&n.createElement("a",ee({tabIndex:0,className:"".concat(D,"-close"),onKeyDown:z,"aria-label":"Close"},te,{onClick:function(i){i.preventDefault(),i.stopPropagation(),T()}}),X.closeIcon),L&&n.createElement("progress",{className:"".concat(D,"-progress"),max:"100",value:$},$+"%"))}),he=U.createContext({}),Fe=function(a){var d=a.children,c=a.classNames;return U.createElement(he.Provider,{value:{classNames:c}},d)},de=8,me=3,ye=16,Le=function(a){var d={offset:de,threshold:me,gap:ye};if(a&&ge(a)==="object"){var c,l,N;d.offset=(c=a.offset)!==null&&c!==void 0?c:de,d.threshold=(l=a.threshold)!==null&&l!==void 0?l:me,d.gap=(N=a.gap)!==null&&N!==void 0?N:ye}return[!!a,d]},be=["className","style","classNames","styles"],we=function(a){var d=a.configList,c=a.placement,l=a.prefixCls,N=a.className,C=a.style,A=a.motion,b=a.onAllNoticeRemoved,P=a.onNoticeClose,F=a.stack,O=n.useContext(he),m=O.classNames,g=n.useRef({}),w=n.useState(null),y=H(w,2),f=y[0],j=y[1],I=n.useState([]),E=H(I,2),S=E[0],x=E[1],u=d.map(function(v){return{config:v,key:String(v.key)}}),p=Le(F),o=H(p,2),e=o[0],r=o[1],s=r.offset,R=r.threshold,_=r.gap,k=e&&(S.length>0||u.length<=R),q=typeof A=="function"?A(c):A;return n.useEffect(function(){e&&S.length>1&&x(function(v){return v.filter(function(L){return u.some(function(T){var z=T.key;return L===z})})})},[S,u,e]),n.useEffect(function(){var v;if(e&&g.current[(v=u[u.length-1])===null||v===void 0?void 0:v.key]){var L;j(g.current[(L=u[u.length-1])===null||L===void 0?void 0:L.key])}},[u,e]),U.createElement(Re,ee({key:c,className:Q(l,"".concat(l,"-").concat(c),m==null?void 0:m.list,N,ue(ue({},"".concat(l,"-stack"),!!e),"".concat(l,"-stack-expanded"),k)),style:C,keys:u,motionAppear:!0},q,{onAllRemoved:function(){b(c)}}),function(v,L){var T=v.config,z=v.className,X=v.style,te=v.index,$=T,D=$.key,M=$.times,i=String(D),h=T,ne=h.className,oe=h.style,G=h.classNames,K=h.styles,Se=Ne(h,be),ae=u.findIndex(function(Z){return Z.key===i}),Y={};if(e){var B=u.length-1-(ae>-1?ae:te-1),fe=c==="top"||c==="bottom"?"-50%":"0";if(B>0){var re,se,ie;Y.height=k?(re=g.current[i])===null||re===void 0?void 0:re.offsetHeight:f==null?void 0:f.offsetHeight;for(var ve=0,ce=0;ce<B;ce++){var le;ve+=((le=g.current[u[u.length-1-ce].key])===null||le===void 0?void 0:le.offsetHeight)+_}var ke=(k?ve:B*s)*(c.startsWith("top")?1:-1),Ee=!k&&f!==null&&f!==void 0&&f.offsetWidth&&(se=g.current[i])!==null&&se!==void 0&&se.offsetWidth?((f==null?void 0:f.offsetWidth)-s*2*(B<3?B:3))/((ie=g.current[i])===null||ie===void 0?void 0:ie.offsetWidth):1;Y.transform="translate3d(".concat(fe,", ").concat(ke,"px, 0) scaleX(").concat(Ee,")")}else Y.transform="translate3d(".concat(fe,", 0, 0)")}return U.createElement("div",{ref:L,className:Q("".concat(l,"-notice-wrapper"),z,G==null?void 0:G.wrapper),style:J(J(J({},X),Y),K==null?void 0:K.wrapper),onMouseEnter:function(){return x(function(W){return W.includes(i)?W:[].concat(V(W),[i])})},onMouseLeave:function(){return x(function(W){return W.filter(function(xe){return xe!==i})})}},U.createElement(_e,ee({},Se,{ref:function(W){ae>-1?g.current[i]=W:delete g.current[i]},prefixCls:l,classNames:G,styles:K,className:Q(ne,m==null?void 0:m.notice),style:oe,times:M,key:D,eventKey:D,onNoticeClose:P,hovering:e&&S.length>0})))})},Me=n.forwardRef(function(t,a){var d=t.prefixCls,c=d===void 0?"rc-notification":d,l=t.container,N=t.motion,C=t.maxCount,A=t.className,b=t.style,P=t.onAllRemoved,F=t.stack,O=t.renderNotifications,m=n.useState([]),g=H(m,2),w=g[0],y=g[1],f=function(e){var r,s=w.find(function(R){return R.key===e});s==null||(r=s.onClose)===null||r===void 0||r.call(s),y(function(R){return R.filter(function(_){return _.key!==e})})};n.useImperativeHandle(a,function(){return{open:function(e){y(function(r){var s=V(r),R=s.findIndex(function(q){return q.key===e.key}),_=J({},e);if(R>=0){var k;_.times=(((k=r[R])===null||k===void 0?void 0:k.times)||0)+1,s[R]=_}else _.times=0,s.push(_);return C>0&&s.length>C&&(s=s.slice(-C)),s})},close:function(e){f(e)},destroy:function(){y([])}}});var j=n.useState({}),I=H(j,2),E=I[0],S=I[1];n.useEffect(function(){var o={};w.forEach(function(e){var r=e.placement,s=r===void 0?"topRight":r;s&&(o[s]=o[s]||[],o[s].push(e))}),Object.keys(E).forEach(function(e){o[e]=o[e]||[]}),S(o)},[w]);var x=function(e){S(function(r){var s=J({},r),R=s[e]||[];return R.length||delete s[e],s})},u=n.useRef(!1);if(n.useEffect(function(){Object.keys(E).length>0?u.current=!0:u.current&&(P==null||P(),u.current=!1)},[E]),!l)return null;var p=Object.keys(E);return pe.createPortal(n.createElement(n.Fragment,null,p.map(function(o){var e=E[o],r=n.createElement(we,{key:o,configList:e,placement:o,prefixCls:c,className:A==null?void 0:A(o),style:b==null?void 0:b(o),motion:N,onNoticeClose:f,onAllNoticeRemoved:x,stack:F});return O?O(r,{prefixCls:c,key:o}):r})),l)}),He=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],Ie=function(){return document.body},Ce=0;function De(){for(var t={},a=arguments.length,d=new Array(a),c=0;c<a;c++)d[c]=arguments[c];return d.forEach(function(l){l&&Object.keys(l).forEach(function(N){var C=l[N];C!==void 0&&(t[N]=C)})}),t}function je(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=t.getContainer,d=a===void 0?Ie:a,c=t.motion,l=t.prefixCls,N=t.maxCount,C=t.className,A=t.style,b=t.onAllRemoved,P=t.stack,F=t.renderNotifications,O=Ne(t,He),m=n.useState(),g=H(m,2),w=g[0],y=g[1],f=n.useRef(),j=n.createElement(Me,{container:w,ref:f,prefixCls:l,motion:c,maxCount:N,className:C,style:A,onAllRemoved:b,stack:P,renderNotifications:F}),I=n.useState([]),E=H(I,2),S=E[0],x=E[1],u=n.useMemo(function(){return{open:function(o){var e=De(O,o);(e.key===null||e.key===void 0)&&(e.key="rc-notification-".concat(Ce),Ce+=1),x(function(r){return[].concat(V(r),[{type:"open",config:e}])})},close:function(o){x(function(e){return[].concat(V(e),[{type:"close",key:o}])})},destroy:function(){x(function(o){return[].concat(V(o),[{type:"destroy"}])})}}},[]);return n.useEffect(function(){y(d())}),n.useEffect(function(){if(f.current&&S.length){S.forEach(function(e){switch(e.type){case"open":f.current.open(e.config);break;case"close":f.current.close(e.key);break;case"destroy":f.current.destroy();break}});var p,o;x(function(e){return(p!==e||!o)&&(p=e,o=e.filter(function(r){return!S.includes(r)})),o})}},[S]),[u,j]}const Ke=U.createContext({});export{Ke as A,_e as N,Fe as a,je as u};
